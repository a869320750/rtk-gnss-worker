# RTK GNSS Worker Dockeræµ‹è¯•ç¯å¢ƒ

æœ¬ç›®å½•æä¾›**å®Œæ•´çš„å®¹å™¨åŒ–æµ‹è¯•ç¯å¢ƒ**ï¼ŒåŒ…æ‹¬çœŸæ­£çš„ç«¯åˆ°ç«¯é›†æˆæµ‹è¯•ã€‚

## ğŸ³ Dockerç‹¬ç«‹æµ‹è¯•

### ä¸€é”®æµ‹è¯•ï¼ˆæ¨èï¼‰
```bash
# è¿è¡Œå®Œæ•´çš„Dockeræµ‹è¯•å¥—ä»¶
./run_docker_test.sh
```

### å®¹å™¨å†…æµ‹è¯•ç±»å‹
```bash
# åœ¨å®¹å™¨å†…è¿è¡Œç‰¹å®šæµ‹è¯•
docker exec -it rtk-test python run_tests.py --type architecture     # æ¶æ„æµ‹è¯•
docker exec -it rtk-test python run_tests.py --type unit            # å•å…ƒæµ‹è¯•  
docker exec -it rtk-test python run_tests.py --type integration     # é›†æˆæµ‹è¯•ï¼ˆå«mockå’ŒçœŸå®ï¼‰
docker exec -it rtk-test python run_tests.py --type real-integration # çœŸæ­£çš„ç«¯åˆ°ç«¯æµ‹è¯• ğŸ†•
docker exec -it rtk-test python run_tests.py --type all             # å…¨éƒ¨æµ‹è¯•
```

## ğŸš€ çœŸæ­£çš„ç«¯åˆ°ç«¯é›†æˆæµ‹è¯• ğŸ†•

### æµ‹è¯•æ¶æ„
```mermaid
graph TB
    subgraph "Mock Services"
        A[NTRIP Mock<br/>æŒç»­å‘é€RTCMæ•°æ®<br/>ç«¯å£:2101] 
        B[Serial Mock<br/>æŒç»­å‘é€NMEAæ•°æ®<br/>ç«¯å£:8888]
    end
    
    subgraph "GNSS Worker"
        C[RTCMçº¿ç¨‹<br/>NTRIPâ†’ä¸²å£]
        D[NMEAçº¿ç¨‹<br/>ä¸²å£â†’JSON]
    end
    
    subgraph "éªŒè¯ç‚¹"
        E[ä½ç½®æ•°æ®æ¥æ”¶]
        F[æ–‡ä»¶è¾“å‡ºéªŒè¯]
        G[çº¿ç¨‹çŠ¶æ€æ£€æŸ¥]
    end
    
    A --> C
    B --> D
    C --> E
    D --> E
    E --> F
    E --> G
```

### æµ‹è¯•å†…å®¹
- âœ… **çœŸå®æ•°æ®æµ**ï¼šä½¿ç”¨å®é™…çš„NTRIPå’Œä¸²å£mockæœåŠ¡
- âœ… **åŒçº¿ç¨‹éªŒè¯**ï¼šéªŒè¯RTCMå’ŒNMEAçº¿ç¨‹ç‹¬ç«‹å·¥ä½œ
- âœ… **ç«¯åˆ°ç«¯æ•°æ®**ï¼šä»RTCMæ¥æ”¶åˆ°ä½ç½®è¾“å‡ºçš„å®Œæ•´æµç¨‹
- âœ… **è¿æ¥çŠ¶æ€**ï¼šéªŒè¯æ‰€æœ‰æœåŠ¡è¿æ¥æ­£å¸¸
- âœ… **æ•°æ®è´¨é‡**ï¼šéªŒè¯æ¥æ”¶åˆ°çš„ä½ç½®æ•°æ®æ ¼å¼å’Œå†…å®¹

## ğŸ“ æµ‹è¯•æ–‡ä»¶ç»„ç»‡

### ğŸ—ï¸ æ¶æ„æµ‹è¯•ï¼ˆåŒçº¿ç¨‹éªŒè¯ï¼‰
- **`test_architecture.py`** - åŒçº¿ç¨‹æ¶æ„ç»“æ„éªŒè¯
- **`test_dual_thread.py`** - åŒçº¿ç¨‹åŠŸèƒ½æµ‹è¯•

### ğŸ”§ å•å…ƒæµ‹è¯•
- **`test_units.py`** - æ ¸å¿ƒç»„ä»¶å•å…ƒæµ‹è¯•
- **`test_gnss_worker.py`** - ä¸»å·¥ä½œå™¨æµ‹è¯•
- **`test_ntrip_client.py`** - NTRIPå®¢æˆ·ç«¯æµ‹è¯•

### ğŸ”— é›†æˆæµ‹è¯•
- **`test_integration.py`** - ç»„ä»¶é›†æˆæµ‹è¯•
- **`test_real_ntrip.py`** - çœŸå®ç¯å¢ƒæµ‹è¯•

### âš™ï¸ é…ç½®æµ‹è¯•
- **`test_unified_config.py`** - ç»Ÿä¸€é…ç½®ç³»ç»Ÿæµ‹è¯•

## ğŸ› ï¸ Dockeræµ‹è¯•ç¯å¢ƒ

### ç›®å½•ç»“æ„
```
tests/
â”œâ”€â”€ Dockerfile.unified          # Dockeré•œåƒå®šä¹‰ ğŸ†•
â”œâ”€â”€ docker-compose.unified.yml  # æµ‹è¯•ç¼–æ’é…ç½®
â”œâ”€â”€ run_docker_test.sh          # Dockeræµ‹è¯•è„šæœ¬
â”œâ”€â”€ run_tests.py                # å®¹å™¨å†…æµ‹è¯•è¿è¡Œå™¨
â”œâ”€â”€ entrypoint.sh               # å®¹å™¨å…¥å£è„šæœ¬
â”œâ”€â”€ test_architecture.py        # åŒçº¿ç¨‹æ¶æ„æµ‹è¯• ğŸ†•
â”œâ”€â”€ test_dual_thread.py         # åŒçº¿ç¨‹åŠŸèƒ½æµ‹è¯• ğŸ†•
â”œâ”€â”€ test_*.py                   # å…¶ä»–æµ‹è¯•æ–‡ä»¶
â”œâ”€â”€ config.json/                # æµ‹è¯•é…ç½®
â”œâ”€â”€ logs/                       # æµ‹è¯•æ—¥å¿—
â””â”€â”€ output/                     # æµ‹è¯•è¾“å‡º
```

### æ ¸å¿ƒç‰¹æ€§
- âœ… å®Œå…¨å®¹å™¨åŒ–çš„æµ‹è¯•ç¯å¢ƒ
- âœ… éš”ç¦»çš„ä¾èµ–å’Œé…ç½®
- âœ… ä¸€é”®è¿è¡Œæ‰€æœ‰æµ‹è¯•
- âœ… è¯¦ç»†çš„æµ‹è¯•æŠ¥å‘Š
- âœ… æ”¯æŒCI/CDé›†æˆ

## ğŸš« ä¸æ”¯æŒæœ¬åœ°æµ‹è¯•

> **é‡è¦**ï¼šæ­¤é¡¹ç›®ä¸“æ³¨äºDockerå®¹å™¨åŒ–æµ‹è¯•ï¼Œä¸æä¾›æœ¬åœ°Pythonæµ‹è¯•æ”¯æŒã€‚
> æ‰€æœ‰æµ‹è¯•éƒ½åº”è¯¥åœ¨Dockerå®¹å™¨å†…è¿è¡Œï¼Œç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§ã€‚

å¦‚éœ€æµ‹è¯•ï¼Œè¯·ä½¿ç”¨ï¼š
```bash
./run_docker_test.sh  # å”¯ä¸€æ¨èçš„æµ‹è¯•æ–¹å¼
```
